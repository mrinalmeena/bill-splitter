<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Bill Splitter</title>
 
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    },
                },
            },
        }
    </script>
   
    <style>
       
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #2d3748;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a5568; 
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
       
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>

<body class="bg-gray-900 text-gray-200 font-inter flex justify-center items-start min-h-screen p-4 sm:p-8">

    <main class="w-full max-w-2xl bg-gray-800 shadow-2xl rounded-2xl overflow-hidden">
        
        <!-- Header Section -->
        <header class="bg-gray-700 p-5 sm:p-6 border-b border-gray-600">
            <h1 class="text-2xl sm:text-3xl font-bold text-white">Advanced Bill Splitter</h1>
            <p class="text-sm sm:text-base text-gray-400 mt-1">Settle your group debts with ease. Who owes whom, and how much?</p>
        </header>

   
        <div class="p-5 sm:p-6 space-y-6">
            <h2 class="text-lg font-semibold text-white border-b border-gray-700 pb-2">Enter Payers</h2>
            
           
            <div id="payers-list" class="space-y-4 max-h-60 overflow-y-auto pr-2">
              
                <div class="flex items-center gap-3 payer-row">
                    <input type="text" placeholder="Enter Name" class="flex-1 bg-gray-700 border border-gray-600 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-200" value="Person 1">
                    <input type="number" placeholder="Amount Paid (₹)" class="w-1/3 bg-gray-700 border border-gray-600 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-200" min="0" step="0.01">
                    <button onclick="removePerson(this)" class="p-2 bg-red-600 hover:bg-red-700 rounded-lg text-white transition duration-200" aria-label="Remove Person">
            
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                    </button>
                </div>
            </div>

            <div class="flex flex-col sm:flex-row justify-between items-center gap-4 pt-4 border-t border-gray-700">
                <button onclick="addPerson()" class="w-full sm:w-auto flex items-center justify-center gap-2 px-5 py-3 bg-indigo-600 hover:bg-indigo-700 rounded-lg text-white font-semibold transition duration-200">
                    
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                    Add Person
                </button>
                <button onclick="calculateSplit()" class="w-full sm:w-auto px-8 py-3 bg-green-600 hover:bg-green-700 rounded-lg text-white text-lg font-bold transition duration-200 shadow-lg">
                    Calculate Split
                </button>
            </div>
        </div>

        
        <div id="results" class="hidden border-t border-gray-600 p-5 sm:p-6 space-y-6">
         
            <div>
                <h2 class="text-lg font-semibold text-white mb-3">Summary</h2>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <div class="bg-gray-700 p-4 rounded-lg text-center">
                        <span class="text-sm text-gray-400 block">Total Bill</span>
                        <span id="total-bill" class="text-xl font-bold text-white">₹0.00</span>
                    </div>
                    <div class="bg-gray-700 p-4 rounded-lg text-center">
                        <span class="text-sm text-gray-400 block">Total People</span>
                        <span id="total-people" class="text-xl font-bold text-white">0</span>
                    </div>
                    <div class="bg-gray-700 p-4 rounded-lg text-center">
                        <span class="text-sm text-gray-400 block">Cost Per Person</span>
                        <span id="cost-per-person" class="text-xl font-bold text-white">₹0.00</span>
                    </div>
                </div>
            </div>

            
            <div>
                <h2 class="text-lg font-semibold text-white mb-3">Who Owes Whom?</h2>
                <ul id="transactions-list" class="space-y-3">
                    
                </ul>
                <div id="message-box" class="hidden mt-3 text-center bg-gray-700 p-4 rounded-lg text-green-400 font-medium"></div>
            </div>
        </div>
    </main>

    <script>
       
        const currencyFormatter = new Intl.NumberFormat('en-IN', {
            style: 'currency',
            currency: 'INR',
        });

        // --- DOM Elements ---
        const payersList = document.getElementById('payers-list');
        const resultsSection = document.getElementById('results');
        const totalBillEl = document.getElementById('total-bill');
        const totalPeopleEl = document.getElementById('total-people');
        const costPerPersonEl = document.getElementById('cost-per-person');
        const transactionsList = document.getElementById('transactions-list');
        const messageBox = document.getElementById('message-box');

     
        const payerRowTemplate = `
            <div class="flex items-center gap-3 payer-row">
                <input type="text" placeholder="Enter Name" class="flex-1 bg-gray-700 border border-gray-600 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-200" value="">
                <input type="number" placeholder="Amount Paid (₹)" class="w-1/3 bg-gray-700 border border-gray-600 text-white rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-200" min="0" step="0.01">
                <button onclick="removePerson(this)" class="p-2 bg-red-600 hover:bg-red-700 rounded-lg text-white transition duration-200" aria-label="Remove Person">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                </button>
            </div>`;
        
   
        function addPerson() {
            const newRow = document.createElement('div');
            newRow.innerHTML = payerRowTemplate;
            
            const rowElement = newRow.firstElementChild;
            
      
            const newIndex = payersList.children.length + 1;
            rowElement.querySelector('input[type="text"]').value = `Person ${newIndex}`;
            
            payersList.appendChild(rowElement);
        }


        function removePerson(button) {

            if (payersList.children.length > 1) {
                const row = button.closest('.payer-row');
                row.remove();
            } else {
                showMessage("You can't remove the last person.", 'error');
            }
        }
        function showMessage(message, type = 'success') {
            messageBox.textContent = message;
            messageBox.className = 'block mt-3 text-center p-4 rounded-lg font-medium'; 
            
            if (type === 'error') {
                messageBox.classList.add('bg-red-900', 'text-red-300');
            } else { 
                messageBox.classList.add('bg-green-900', 'text-green-300');
            }
        }

        function calculateSplit() {
       
            const people = [];
            let totalBill = 0;
            const payerRows = payersList.querySelectorAll('.payer-row');

            for (const row of payerRows) {
                const name = row.querySelector('input[type="text"]').value.trim();
                const paid = parseFloat(row.querySelector('input[type="number"]').value) || 0;
                
                
                if (name) {
                    people.push({ name, paid, balance: 0 });
                    totalBill += paid;
                }
            }

            const numPeople = people.length;

       
            transactionsList.innerHTML = '';
            messageBox.className = 'hidden'; 

            if (numPeople === 0) {
                showMessage('Please add at least one person.', 'error');
                resultsSection.classList.add('hidden');
                return;
            }
            if (totalBill <= 0) {
                showMessage('The total bill must be greater than ₹0.', 'error');
                resultsSection.classList.add('hidden');
                return;
            }

            // 2. Calculate Balances
            const costPerPerson = totalBill / numPeople;
            
            const debtors = [];
            const creditors = [];

            for (const person of people) {
                person.balance = person.paid - costPerPerson;
                if (person.balance < 0) {
                    debtors.push(person);
                } else if (person.balance > 0) {
                    creditors.push(person);
                }
            }

          
            debtors.sort((a, b) => a.balance - b.balance);
            creditors.sort((a, b) => b.balance - a.balance);

      
            const transactions = [];
            let debtorIndex = 0;
            let creditorIndex = 0;

            while (debtorIndex < debtors.length && creditorIndex < creditors.length) {
                const debtor = debtors[debtorIndex];
                const creditor = creditors[creditorIndex];
                const debtAmount = Math.abs(debtor.balance);
                const creditAmount = creditor.balance;

                
                const EPSILON = 0.001;

              
                const transferAmount = Math.min(debtAmount, creditAmount);

                if (transferAmount > EPSILON) {
    
                    transactions.push({
                        from: debtor.name,
                        to: creditor.name,
                        amount: transferAmount
                    });

        
                    debtor.balance += transferAmount;
                    creditor.balance -= transferAmount;
                }

                if (Math.abs(debtor.balance) < EPSILON) {
                    debtorIndex++;
                }
                if (Math.abs(creditor.balance) < EPSILON) {
                    creditorIndex++;
                }
            }

         
            resultsSection.classList.remove('hidden');

            totalBillEl.textContent = currencyFormatter.format(totalBill);
            totalPeopleEl.textContent = numPeople;
            costPerPersonEl.textContent = currencyFormatter.format(costPerPerson);

       
            if (transactions.length === 0) {
                showMessage('Everyone is settled up!', 'success');
            } else {
                for (const trans of transactions) {
                    const li = document.createElement('li');
                    li.className = 'flex justify-between items-center bg-gray-700 p-3 rounded-lg';
                    li.innerHTML = `
                        <span class="font-medium text-gray-300">
                            ${trans.from} 
                            <span class="text-indigo-400 mx-1">➔</span> 
                            ${trans.to}
                        </span>
                        <span class="font-bold text-lg text-white">${currencyFormatter.format(trans.amount)}</span>
                    `;
                    transactionsList.appendChild(li);
                }
            }
        }
        
       
        document.addEventListener('DOMContentLoaded', () => {
            addPerson();
          
            document.querySelector('.payer-row input[type="number"]').value = '';
        });

    </script>

</body>
</html>
